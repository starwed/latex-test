\subsection{The NRQED Lagrangian}

We want to construct an effective Lagrangian in the nonrelativistic limit.  Our goal is to calculate the leading order corrections to the $g$-factor, which are corrections of order $\alpha^2$.  To this end, we need terms in the effective nonrelativistic Lagrangian which are equivalent corrections.
% is this name really right?
\subsubsection{position space operators}

\begin{tabular}{l|c|ccc}
& Order	&	P	&	T	&	$\dagger$	\\
\hline
$eE_i$	&$m^2v^3$	&	-	& 	+	&	+		\\
$eB_i$	&$m^2v^2$	&	+	&   -	&	+		\\
$D_i$		& mv	&	-	&	+	&	-		\\
$D_0$		& mv	&	+	&	-	&	-		\\
$S_i$		& 1		&	+	&	-	&	+		\\
$i$		& 1		&	+	&	-	&	-		\\
\end{tabular}


There are several symmetries that terms in the Lagrangian must preserve: spatial reflection, time reversal, gauge invariance, and Hermiticity.  Gauge invariance is taken care of by only considering gauge-invariant operators.

All of the possible spin-space structures preserve spatial parity.  If the term in the Lagrangian is to obey such a symmetry, then any allowed collection of position-space operators must be themselves invariant under reflection.  

Each term must also be invariant under time reversal.  The spin operator $S_i$ flips sign under time reversal.  Thus, $\bar{S}_{ij}$ is even, and $\bar{S}_{ijk}$ odd, under the same transformation.  $E_i$ and $D_i$ are even, while $B_i$ is odd.  Any set of operators with definite behavior under time reversal, though, can be made invariant by including an extra factor of $i$.  So even if some term $ABC$ is odd, $iABC$ will be even.

Finally, any sequence of operators can be made Hermitian by simply adding the Hermitian conjugate; if we wish to include a term $ABC$ in the Lagrangian, we add $C^\dagger B^\dagger A^\dagger$.  Since all the operator	s under consideration are either Hermitian or anti-Hermitian, this means that exactly one of $ABC \pm CBA$ will be allowed.  The spin space operators are all Hermitian of themselves, and commute with all other operators, so only the position space operators are nontrivial.

Thus for any possible set of operators, first it is determined if such a set is allowed by considerations of parity.  Then, whether an additional factor of $i$ is needed is determined by examining the properties under time reversal.  Finally, the allowed Hermitian terms are enumerated.


%TODO add bit about order of operators as well, either before this or after it.
Of the ``building blocks'' for the general Lagrangian, those odd in parity are also odd in $v$.  And those even in parity are of an order even in $v$.  So only terms of an order even in $v$ can possibly be allowed under parity, and at the same time every such term will have the correct symmetry properties under spatial reflection.

First consider terms of leading order $mv^2$.  What collections of position space operators exist?  $E$ is already too high of an order, leaving only that with two powers of $D$:
%TODO clean up notation -- shouldn't use O here, probably
\beq
 \text{Sets of } \mathcal{O}(mv^2) \text{ combinations} = \{ \frac{1}{m} D_i D_j \} 
\eeq
This is in addition to the single permitted term containing $e\Phi$ which is not, by itself, gauge-invariant.
 
 Next consider terms of order $mv^4$.  We could have up to a single power of $E$, or only the long derivative operators:
 
\beq
 \text{Set of } \mathcal{O}(mv^2) \text{ combinations} = \{ \frac{1}{m^3} D_i D_j D_k D_\ell, \, \frac{1}{m^2} e E_i D_j \} 
\eeq

The leading order term in $B$ is just $\frac{e}{m}B_i$.

The order $\frac{e}{m} B_i v^2$ terms are drawn from:
\beq
 \text{Set of } \mathcal{O}(\frac{e}{m} B v^2) \text{ combinations} = \{ \frac{e}{m^3} D_i D_j B_k \}
\eeq


\subsubsection{Contraction of terms}

In this nonrelativistic theory the Lagrangian need not be Lorentz invariant, but must still be Galilean invariant.  All the operators we consider transform as 3-vectors or higher order 3-tensors.  To form allowed terms, all indices must be somehow contracted.

Above, all relevant sets of position space operators are considered for each order of term.  The greatest number of indices free was four.  These must be contracted with order unity structures, which as well as the spin operators with up to four indices ($S_i$, $\Sb_{ij}$, $\Sb_{ijk}$,$\Sb_{ijk\ell}$) include $\delta_{ij}$ and the completely antisymmetric tensor $\epsilon_{ijk}$.

\begin{itemize}
\item The only structure with one index is just $S_i$.

\item With two indices, there are the simple structures $\Sb_{ij}$ and $\delta_{ij}$, and also $S_i \epsilon_{ijk}$.

\item With three indices, there are $\epsilon_{ijk}$ and $\Sb_{ijk}$ as well as $\delta_{ij} S_k$ or $\Sb_{ij} \epsilon_{jk\ell}$.

\item The only position space operator with four indices is just $D_i D_j D_k D_\ell$.  While there are a fairly large number of order unity structures with four indices, any with spin operators are forbidden because of the kinetic nature of the term.  So only $\delta_{ij} \delta_{k\ell}$ need be considered.
\end{itemize}

Above are categorized the possible sets of position space operators for each order, and the ways of contracting them by number of indices.  The next step is to write all Hermitian combinations we can form from these operators.  This will form a complete catalogue of allowed terms in the Lagrangian.

%TODO address that D_i D_j \epsilon_{ijk} \sim B_k
The term $D_i D_j$ has two indices.  There are three ways to contract it: with $\delta_{ij}$, $\Sb_{ij}$, or $S_k \epsilon_{ijk}$.  Since kinetic terms with spin are not considered, that only leaves one possible term: $\v{D}^2$.  This term is Hermitian in and of itself.  It has mass dimension two, so the term as it appears in the Lagrangian will be:
\beq
	 D_i D_j  \to \frac{\v{D^2}}{2m}
\eeq 

Terms from the set $E_i D_j$ also have two indices.  It can be contracted with all three of $\delta_{ij}$, $\Sb_{ij}$, or $i S_k \epsilon_{ijk}$.   
$E_i$, $\delta_{ij}$ and $\Sb_{ij}$ are Hermitian, while $D_j$ and $i S_k \epsilon_{ijk}$ are anti-Hermitian.  It is convenient to use that $[D_j, E_i] = \grad_j E_i$.

The Hermitian combination with $\delta_{ij}$ is 
\beq
	(D_i E_j - E_j D_i) \delta_{ij} \to \frac{ \grad \cdot \v{E}  }{4m^2} = \frac{ \grad \cdot \v{E} }{4m^2}
\eeq

The Hermitian combination with $\Sb_{ij}$ is
\beq
	(D_i E_j - E_j D_i)  \Sb_{ij} \to \frac{ \Sb_{ij} \partial_i E_j }{4m^2} 
\eeq

The Hermitian combination with $i S_k \epsilon_{ijk}$ is
\beq
	(D_i E_j + E_j D_i) \to i S_k \epsilon_{ijk} \to  \frac{ i\v{S} \cdot ( \v{D} \times \v{E} + \v{E} \times \v{D} ) }{4m^2}
\eeq

A single power of the magnetic field, $B_i$ may only be contracted with $S_i$.  So the term is
\beq
	\frac{e}{m} \v{S} \cdot \v{B}
\eeq 

The second order terms involving the magnetic field are drawn from the set $D_i D_j B_k$.  There are four order-unity structures which have three indices, but only two of those need be considered.  This is because $\v{D} \times \v{D} \sim \v{B}$ and $\v{D} \times \v{B} =0$.  If is not assumed that $[D_i, B_j] = 0$ then the allowed Hermitian combinations will be with $D_i D_j B_k + B_k D_j D_i$ and $D_i B_j D_k$.

While $[D_i, D_j] \neq 0$, it does produce another term proportional to $B$ and thus, smaller than considered.  So for instance, $D_i D_j B_i$ need not be considered separate from $D_j D_i B_i$.   
\beqa
(D_i D_j B_k + B_k D_j D_i) \delta_{ij} S_k 
	&\to&	 \frac{e}{m}\frac{ \v{D}^2 (\v{S} \cdot \v{B}) + (\v{S} \cdot \v{B}) \v{D}^2 }{4m^2}	\\  
(D_i D_j B_k + B_k D_j D_i) \delta_{jk} S_i 
	&\to&	 \frac{e}{m}\frac{ (\v{S} \cdot \v{D}) (\v{D} \cdot \v{B}) + (\v{B} \cdot \v{D}) (\v{S} \cdot \v{D}) }{4m^2}	\\
D_i B_j D_k \delta_{ij} S_k  
	&\to&	 \frac{e}{m}\frac{ (\v{S} \cdot \v{D}) (\v{B} \cdot \v{D}) + (\v{D} \cdot \v{B}) (\v{S} \cdot \v{B}) }{4m^2}		\\ 
\eeqa

\beqa
(D_i D_j B_k + B_k D_j D_i) \Sb_{ijk} 
	&\to&	\frac{e}{m}\frac{ \Sb_{ijk} (D_i D_j B_k + B_k D_j D_i)   }{4m^2}	\\
D_i B_j D_k \Sb_{ijk} 
	&\to&	\frac{e}{m}\frac{ \Sb_{ijk} D_i B_j D_k  }{4m^2}	\\  
\eeqa

Finally, there is only one way to contract $D_i D_j D_k D_\ell$, which is as $\v{D}^4$.  Again, variations such as $D_i \v{D}^2 D_i$ need not be considered because they just reproduce already considered terms with $B$.
\beqa
	D_i D_j D_k D_\ell \delta_{ij} \delta_{k \ell} 
		&\to& \frac{\v{D}^4}{8m^3}
\eeqa
   
   
\beq \label{eq:nrLFirstOrder}
	\mathcal{L}_{NRQED} = \fnrb \Bigg\{ iD_0 +  \frac{\v{D}^2}{2m}  +  c_F \frac{e}{m} \v{S} \cdot \v{B}\Bigg \} \fnr
\eeq 

%%%%%%%% Lagrangian
\beq \label{eq:nrLv4}
	\mathcal{L}_{mv^4} = \fnrb \Bigg\{
		\frac{\v{D}^4}{8m^2}
		+ c_D \frac{e (\v{D} \cdot \v{E} - \v{E} \cdot \v{D})}{8m^2} 
		+ c_Q \frac{eQ_{ij}(D_i E_j - E_i D_j)}{8m^2}
		+ c_S \frac{ i e \v{S} \cdot(\v{D} \times \v{E} - \v{E} \times \v{D}}{8m^2} \Bigg \} \fnr
\eeq


\beq \label{eq:nrLBv2} \begin{split}
	\mathcal{L}_{Bv^2} = &
		\fnrb \Bigg\{
			c_{W1} \frac{ e \v{D}^2 \v{S} \cdot \v{B} + \v{S} \cdot \v{B} \v{D}^2 }{8m^3}
			- c_{W2} \frac{e D_i (\v{S} \cdot \v{B}) D_i}{4m^3}
			+c_{p'p} \frac{ e [ (\v{S}\cdot \v{D})(\v{B} \cdot \v{D}) + (\v{B} \cdot \v{D})(\v{S}\cdot \v{D})]}{8m^3}
\\ &		+ c_{T_1} \frac{ e \bar{S}_{ijk} (D_i D_j B_k + B_k D_j D_i)}{8m^3}
		+ c_{T_2} \frac{ e \bar{S}_{ijk} D_i B_j D_k }{8m^3} \Bigg \} \fnr
\end{split}\eeq

\subsubsection{Full Lagrangian}
The full Lagrangian we consider is then:

\beq \label{eq:nrLFull}
\begin{split}
\mathcal{L}_{NRQED} = & \fnrb \Bigg\{
		iD_0 +  \frac{\v{D}^2}{2m}  + 	\frac{\v{D}^4}{8m^2}
		 + c_F \frac{e}{m} \v{S} \cdot \v{B}
		+ c_D \frac{e (\v{D} \cdot \v{E} - \v{E} \cdot \v{D})}{8m^2} 
		+ c_Q \frac{eQ_{ij}(D_i E_j - E_i D_j)}{8m^2}
\\	& + c_S \frac{ i e \v{S} \cdot(\v{D} \times \v{E} - \v{E} \times \v{D}}{8m^2}
		+ c_{W1} \frac{ e \v{D}^2 \v{S} \cdot \v{B} + \v{S} \cdot \v{B} \v{D}^2 }{8m^3}
		- c_{W2} \frac{e D_i (\v{S} \cdot \v{B}) D_i}{4m^3}
\\	&		+c_{p'p} \frac{ e [ (\v{S}\cdot \v{D})(\v{B} \cdot \v{D}) + (\v{B} \cdot \v{D})(\v{S}\cdot \v{D})]}{8m^3}
 	+ c_{T_1} \frac{ e \bar{S}_{ijk} (D_i D_j B_k + B_k D_j D_i)}{8m^3}
		+ c_{T_2} \frac{ e \bar{S}_{ijk} D_i B_j D_k }{8m^3} 
		\Bigg \} \fnr
\end{split}
\eeq


One of the features of this Lagrangian is that every coefficient is fixed by the one-photon interaction.  Although some terms might represent two-photon interactions, they are terms like $\v{S} \cdot \v{A} \times \v{E}$, whose coefficient is fixed by the gauge-invariant term $\v{S} \cdot \v{D} \times \v{E}$.  This in turn means that we can calculate the corrections to the $g$-factor by considering only one-photon interactions.

%%%%%%  OLD OLD OLD
\subsubsection{Order of terms}
%TODO Discussion of energy scales -- possibly move this into introduction, since it applies to each calculation
We consider constant, infinitesimal external magnetic fields, so we need only consider terms linear in $\v{B}$.

The velocity of the particles in our bound state system will be $v \sim \alpha$.

The electric field we consider is the Coulomb field, so $e\Phi \sim m Z\alpha^2 \sim mv^2$, and $eE \sim m^2v^3$.

Each derivative of the electric field will add an additional factor of $mv$, so the operator $\v{D}$ can be taken to be of this order.

We need to keep terms up to order $mv^4$ and $\frac{B}{m} v^2$ in order to calculate the $g$-factor to the necessary precision.  We include $mv^4$ terms so we can be sure that there are no effects entering from second-order perturbation theory.


%TODO insert qualifications on external field
\subsubsection{Constraints on the form of the Lagrangian}
The Lagrangian is constrained to obey several symmetries.  It must be invariant under the symmetries of parity and time reversal.  It must also be invariant under Galilean transformations.  The Lagrangian must also be Hermitian, and gauge invariant.

What are the gauge invariant building blocks we can use to construct this Lagrangian?  We have the external fields $\v{E}$ and $\v{B}$, the spin operators $\v{S}$, and the long derivative $\v{D} = \v{\partial} - i e\v{A}$.  The fields should always be accompanied by the charge $e$ of the particle.

When considering the case of higher spin particles, we might consider terms quadratic and above in spin operators.  For a particle of spin $s$, there must be $(2s+1)^2$ independent hermitian operators.  We can span this set of operators by considering products of up to $2s$ spin matrices which are symmetric and traceless in every vector index.  For example, for spin-$1$ we have quadratic, in addition to $I$ and $S_i$, five independent structures of the form $ S_i S_j + S_j S_i + \delta_{ij} \v{S}$.




We also have the scalar $D_0$, however, we need only include a single such term because we insist on having only one power of the time derivative.

To consider possible terms, we need to know how each of the above behave under the discrete transformations and Hermitian conjugate.  The signs under these transformations are listed in the table below.  (Also included is the imaginary number $i$.)


\begin{tabular}{l|c|ccc}
& Order	&	P	&	T	&	$\dagger$	\\
\hline
$eE_i$	&$m^2v^3$	&	-	& 	+	&	+		\\
$eB_i$	&$m^2v^2$	&	+	&   -	&	+		\\
$D_i$		& mv	&	-	&	+	&	-		\\
$D_0$		& mv	&	+	&	-	&	-		\\
$S_i$		& 1		&	+	&	-	&	+		\\
$i$		& 1		&	+	&	-	&	-		\\
\end{tabular}

\include{SpinSpaceOperators}






