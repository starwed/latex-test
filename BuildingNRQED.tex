\section{Constructing the NRQED Lagrangian}





We want to construct an effective Lagrangian in the nonrelativistic limit.  Our goal is to calculate the leading order corrections to the $g$-factor, which are corrections of order $\alpha^2$.  To this end, we need terms in the effective nonrelativistic Lagrangian which are equivalent corrections.


%TODO insert qualifications on external field
\subsection{Constraints on the form of the Lagrangian}
The Lagrangian is constrained to obey several symmetries.  It must be invariant under the symmetries of parity and time reversal.  It must also be invariant under Galilean transformations.  The Lagrangian must also be Hermitian, and gauge invariant.

What are the gauge invariant building blocks we can use to construct this Lagrangian?  We have the fields $\v{E}$ and $\v{B}$, the spin operators $\v{S}$, and the long derivative $\v{D} = \v{\partial} - i e\v{A}$.  The fields should always be accompanied by the charge $e$ of the particle.

When considering the case of higher spin particles, we might consider terms quadratic and above in spin operators.  For a particle of spin $s$, there must be $(2s+1)^2$ independent hermitian operators.  We can span this set of operators by considering products of up to $2s$ spin matrices which are symmetric and traceless in every vector index.  For example, for spin-$1$ we have quadratic, in addition to $I$ and $S_i$, five independent structures of the form $ S_i S_j + S_j S_i + \delta_{ij} \v{S}$.  This idea is pursued further in a section below.


We also have the scalar $D_0$, however, we need only include a single such term because we insist on having only one power of the time derivative.



\subsubsection{Energy Scales}

The effective Lagrangian contains an infinite number of terms.  But these terms may be organised by the order of their contribution to scattering.  Then, up to a particular order there are only a finite number of terms --- and for the first couple of orders this finite number is quite small and manageable.

Consider again the particular physical situation of interest: a loosely bound state system of two charged particles, each with arbitrary spin, placed in an infinitesimal magnetic field.  It is crucial that the system is loosely bound, so that the entire system is nonrelativistic.  For now it is assumed that recoil effects are ignored.  

Then what are the energy scales of this particular problem?  In addition to the mass of the particle, there are two: one is related to the external magnetic field, an energy scale of $ e/m \abs{\v{B}}$.  The other is related to the kinetic energy or momentum of the particle.  There is an electric field present as well, representing the interaction between the bound state particles.  But by the quantum virial theorem the Coulomb potential is proportional to the kinetic energy, and so is not an independent energy scale.  In general kinetic energy and momentum might be considered seprate energy scales, but in the nonrelativistic regime are just $mv$ and $(1/2) mv^2$.

Both of these energy scales are nonrelativistic --- that is, small compared to the mass of the particle.  So the effective Lagrangian represents an expansion in the small quantities $e/m^2 B$ and $p/m = v$.  However, the calculation of the gyromagnetic ratio involves only linear terms in the magnetic field. (The $g$-factor is defined by the linear response to an infinitesimal magnetic field.)  So no terms quadratic in $B$ are needed.

The goal is to calculate corrections to the $g$-factor of up to $\mathcal{O}(\alpha^2)$.  In the bound state system $v \sim Z\alpha$, so in the Lagrangian should definitely be included terms of up to order $(e/m) B v^2$.  It will also be necessary to consider terms of order $mv^4$, for they {\it might} effect the calculation of the $g$-factor through perturbation theory. 

What is the exact order of each term?  The magnetic field defines its own scale, but the scale of operators $D$, $A_0$, and $E$ come from the particular bound state.

%TODO more detailed explanation?
The term involving the Coulomb potential, $e A_0 = Z e^2 / r^2$ is of order $mv^2$.  The first derivative $ \partial_i \Phi =E_i$ is of order $mv^3$.  The operator $\grad$ may then be said to be of order $mv$.
\subsubsection{Discrete Constraints}
All the building blocks have been chosen so that their transformation under rotation is clear.  If a term has an index, it transforms like a 3-vector.  (Considering this nonrelativistic theory, there are no upper or lower indices.)  The Lagrangian must also be symmetric under the discrete symmetries of refleciton and time reversal, and terms must be Hermitian.  

To construct terms that obey these symmetries, it is necessary to know how the building blocks themselves transform under spatial reflections and time reversal, as well as under complex conjugation.
 \begin{itemize}
   \item  Under spatial reflections, $\v{E}$ and $\v{D}$ are vectors, and so are odd under P.  While $\v{B}$  and $\v{S}$ are pseudovectors, even under P.
   \item  $E$ and $D$ are even under time reversal, while spin and the magnetic field are odd.  Also, under time reversal imaginary constant $i$ is also odd.
   \item Under complex conjugation $E$, $B$ and $S$ are Hermitian, while $D_i$, $D_0$ and (obviously) $i$ change sign. 
 \end{itemize}
 
 For reference, all these properties are tabulated below:

 
\begin{tabular}{l|c|ccc}
& Order	&	P	&	T	&	$\dagger$	\\
\hline
$eE_i$	&$m^2v^3$	&	-	& 	+	&	+		\\
$eB_i$	&$m^2v^2$	&	+	&   -	&	+		\\
$D_i$		& $mv$	&	-	&	+	&	-		\\
$D_0$		& $mv^2$	&	+	&	-	&	-		\\
$S_i$		& 1		&	+	&	-	&	+		\\
$i$		& 1		&	+	&	-	&	-		\\
\end{tabular}

\subsection{Properties of $D_i$}
Before going any further, note that it would be possible to write the entire Lagrangian without explicitly writing $B$.  Instead we could write antisymmetric combinations of $D_i$.  

Consider a term containing $D_i D_j \epsilon_{ijk}$.  First write them using $\v{D} = \grad - i e\v{A}$:

\beq
	(\v{D} \times \v{D}) = D_i D_j \epsilon_{ijk} = (\grad_i - ieA_i)(\grad_j - ieA_j) \epsilon_{ijk}
\eeq

Or in full as
\beq
	= (\grad_i \grad_j -ie\grad_i A_j - ie\grad_j A_i - e^2 A_i A_j) \epsilon_{ijk}
\eeq
The antisymmetric tensor will kill the first and last terms, leaving
\beq
	= -ie (\grad_i A_j + \grad_j A_i) \epsilon_{ijk}
\eeq
We can use put this in the form of a commutator by switching indices in the second term: $\grad_j A_i \epsilon_{ijk} = - \grad_i A_j \epsilon_{ijk}$
\beq
	= -ie [ \grad_i, A_j] \epsilon_{ijk}
\eeq
and of course the commutator between $\grad$ and any field will just be the derivative of that field.
\beq
	= -ie \partial_i A_j \epsilon_{ijk}
\eeq
Finally, from Maxwell's equations this is just  $-ie B_k$, so 
\beq
	(\v{D} \times \v{D})_k = -i e B_k
\eeq

Going the other way, the commutator $[D_i, B_i]$ can be shown to vanish:
\beq
	[D_i, B_i] = D_i ( \epsilon_{ijk} D_j D_k ) - ( \epsilon_{ijk} D_j D_k ) D_i
			= \epsilon_{ijk} (D_i D_j D_k - D_j D_k D_i)
\eeq
Taking the second term and taking an even permutation of the indices: $i \to k \to j \to i$ we show that
\beq
	[D_i, B_i] = \epsilon_{ijk} (D_i D_j D_k - D_i D_j D_k) = 0
\eeq


\input{SpinSpaceOperators}

% is this name really right?
\subsection{Composition of position space operators}

There are several symmetries that terms in the Lagrangian must preserve: spatial reflection, time reversal, gauge invariance, and Hermiticity.  Gauge invariance is taken care of by only considering gauge-invariant operators.

All of the possible spin-space structures preserve spatial parity.  If the term in the Lagrangian is to obey such a symmetry, then any allowed collection of position-space operators must be themselves invariant under reflection.  

Each term must also be invariant under time reversal.  The spin operator $S_i$ flips sign under time reversal.  Thus, $\bar{S}_{ij}$ is even, and $\bar{S}_{ijk}$ odd, under the same transformation.  $E_i$ and $D_i$ are even, while $B_i$ is odd.  Any set of operators with definite behavior under time reversal, though, can be made invariant by including an extra factor of $i$.  So even if some term $ABC$ is odd, $iABC$ will be even.

Finally, any sequence of operators can be made Hermitian by simply adding the Hermitian conjugate; if we wish to include a term $ABC$ in the Lagrangian, we add $C^\dagger B^\dagger A^\dagger$.  Since all the operator	s under consideration are either Hermitian or anti-Hermitian, this means that exactly one of $ABC \pm CBA$ will be allowed.  The spin space operators are all Hermitian of themselves, and commute with all other operators, so only the position space operators are nontrivial.

Thus for any possible set of operators, first it is determined if such a set is allowed by considerations of parity.  Then, whether an additional factor of $i$ is needed is determined by examining the properties under time reversal.  Finally, the allowed Hermitian terms are enumerated.

Of the ``building blocks'' for the general Lagrangian, those odd in parity are also odd in $v$.  And those even in parity are of an order even in $v$.  So only terms of an order even in $v$ can possibly be allowed under parity, and at the same time every such term will have the correct symmetry properties under spatial reflection.

First consider terms of leading order $mv^2$.  What collections of position space operators exist?  $E$ is already too high of an order, leaving only that with two powers of $D$:
%TODO clean up notation -- shouldn't use O here, probably
\beq
 \text{Sets of } \mathcal{O}(mv^2) \text{ combinations} = \{ \frac{1}{m} D_i D_j \} 
\eeq
This is in addition to the single permitted term containing $e\Phi$ which is not, by itself, gauge-invariant.
 
 Next consider terms of order $mv^4$.  We could have up to a single power of $E$, or only the long derivative operators:
 
\beq
 \text{Set of } \mathcal{O}(mv^2) \text{ combinations} = \{ \frac{1}{m^3} D_i D_j D_k D_\ell, \, \frac{1}{m^2} e E_i D_j \} 
\eeq

The leading order term in $B$ is just $\frac{e}{m}B_i$.

The order $\frac{e}{m} B_i v^2$ terms are drawn from:
\beq
 \text{Set of } \mathcal{O}(\frac{e}{m} B v^2) \text{ combinations} = \{ \frac{e}{m^3} D_i D_j B_k \}
\eeq


\subsubsection{Contraction of terms}

In this nonrelativistic theory the Lagrangian need not be Lorentz invariant, but must still be Galilean invariant.  All the operators we consider transform as 3-vectors or higher order 3-tensors.  To form allowed terms, all indices must be somehow contracted.

Above, all relevant sets of position space operators are considered for each order of term.  The greatest number of indices free was four.  These must be contracted with order unity structures, which as well as the spin operators with up to four indices ($S_i$, $\Sb_{ij}$, $\Sb_{ijk}$,$\Sb_{ijk\ell}$) include $\delta_{ij}$ and the completely antisymmetric tensor $\epsilon_{ijk}$.

\begin{itemize}
\item The only structure with one index is just $S_i$.

\item With two indices, there are the simple structures $\Sb_{ij}$ and $\delta_{ij}$, and also $S_i \epsilon_{ijk}$.

\item With three indices, there are $\epsilon_{ijk}$ and $\Sb_{ijk}$ as well as $\delta_{ij} S_k$ or $\Sb_{ij} \epsilon_{jk\ell}$.

\item The only position space operator with four indices is just $D_i D_j D_k D_\ell$.  While there are a fairly large number of order unity structures with four indices, any with spin operators are forbidden because of the kinetic nature of the term.  So only $\delta_{ij} \delta_{k\ell}$ need be considered.
\end{itemize}

Above are categorized the possible sets of position space operators for each order, and the ways of contracting them by number of indices.  The next step is to write all Hermitian combinations we can form from these operators.  This will form a complete catalogue of allowed terms in the Lagrangian.

Some terms which on the surface appear distinct might in fact be identical.  One identity of this nature is
\beq
	D_i D_j \epsilon_{ijk} = -ie B_k 
\eeq  
Which means that any term where two long derivative terms are contracted with the antisymmetric tensor will be equivalent to some already catalogued term involving $B$.

Similarly, 
%TODO check sign
\beq
	[D_i, D_j] = -ie (\partial_i A_j - \partial_j A_i) = -ie F_{ij} = -ie \epsilon_{ijk} B_k 
\eeq
so terms which appear distinct because of the ordering of two long derivative operators are really the same, up to some difference that is absorbed into a term involving $B$.  

Finally, while in the general case $[D_i, B_j] \neq 0$, it is always true that $[D_i, B_j] = 0$.

So many apparently distinct terms may be rewritten and absorbed as the combination of several already accounted for terms.  As an example, it is not necessary to write a term such as $D_i D_j D_i D_j$ in the Lagrangian.  It can be rewritten as
\beqa
	D_i D_j D_i D_j 
		&=& D_i D_i D_j D_j + D_i  [D_i, D_j] D_j						\\
		&=& \v{D}^4 - ie  D_i \epsilon_{ijk} B_k D_j					\\
		&=& \v{D}^4  -ie \epsilon_{ijk} (D_i D_j B_k + [B_k, D_j] )		\\ 
		&=&	\v{D}^4 - e^2 B^2  + ie \epsilon_{ijk} D_i (\partial_j B_k)
\eeqa

%TODO address that D_i D_j \epsilon_{ijk} \sim B_k
The term $D_i D_j$ has two indices.  There are three ways to contract it: with $\delta_{ij}$, $\Sb_{ij}$, or $S_k \epsilon_{ijk}$.  Since kinetic terms with spin are not considered, that only leaves one possible term: $\v{D}^2$.  This term is Hermitian in and of itself.  It has mass dimension two, so the term as it appears in the Lagrangian will be:
\beq
	 D_i D_j  \to \frac{\v{D^2}}{2m}
\eeq 

Terms from the set $E_i D_j$ also have two indices.  It can be contracted with all three of $\delta_{ij}$, $\Sb_{ij}$, or $i S_k \epsilon_{ijk}$.   
$E_i$, $\delta_{ij}$ and $\Sb_{ij}$ are Hermitian, while $D_j$ and $i S_k \epsilon_{ijk}$ are anti-Hermitian.  It is convenient to use that $[D_j, E_i] = \grad_j E_i$.

The Hermitian combination with $\delta_{ij}$ is 
\beq
	(D_i E_j - E_j D_i) \delta_{ij} \to \frac{ \grad \cdot \v{E}  }{4m^2} = \frac{ \grad \cdot \v{E} }{4m^2}
\eeq

The Hermitian combination with $\Sb_{ij}$ is
\beq
	(D_i E_j - E_j D_i)  \Sb_{ij} \to \frac{ \Sb_{ij} \partial_i E_j }{4m^2} 
\eeq

The Hermitian combination with $i S_k \epsilon_{ijk}$ is
\beq
	(D_i E_j + E_j D_i) \to i S_k \epsilon_{ijk} \to  \frac{ i\v{S} \cdot ( \v{D} \times \v{E} + \v{E} \times \v{D} ) }{4m^2}
\eeq

A single power of the magnetic field, $B_i$ may only be contracted with $S_i$.  So the term is
\beq
	\frac{e}{m} \v{S} \cdot \v{B}
\eeq 

The second order terms involving the magnetic field are drawn from the set $D_i D_j B_k$.  There are four order-unity structures which have three indices, but only two of those need be considered.  This is because $\v{D} \times \v{D} \sim \v{B}$ and $\v{D} \times \v{B} =0$.  If is not assumed that $[D_i, B_j] = 0$ then the allowed Hermitian combinations will be with $D_i D_j B_k + B_k D_j D_i$ and $D_i B_j D_k$.

While $[D_i, D_j] \neq 0$, it does produce another term proportional to $B$ and thus, smaller than considered.  So for instance, $D_i D_j B_i$ need not be considered separate from $D_j D_i B_i$.   
\beqa
(D_i D_j B_k + B_k D_j D_i) \delta_{ij} S_k 
	&\to&	 \frac{e}{m}\frac{ \v{D}^2 (\v{S} \cdot \v{B}) + (\v{S} \cdot \v{B}) \v{D}^2 }{4m^2}	\\  
(D_i D_j B_k + B_k D_j D_i) \delta_{jk} S_i 
	&\to&	 \frac{e}{m}\frac{ (\v{S} \cdot \v{D}) (\v{D} \cdot \v{B}) + (\v{B} \cdot \v{D}) (\v{S} \cdot \v{D}) }{4m^2}	\\
D_i B_j D_k \delta_{ij} S_k  
	&\to&	 \frac{e}{m}\frac{ (\v{S} \cdot \v{D}) (\v{B} \cdot \v{D}) + (\v{D} \cdot \v{B}) (\v{S} \cdot \v{B}) }{4m^2}		\\ 
\eeqa

\beqa
(D_i D_j B_k + B_k D_j D_i) \Sb_{ijk} 
	&\to&	\frac{e}{m}\frac{ \Sb_{ijk} (D_i D_j B_k + B_k D_j D_i)   }{4m^2}	\\
D_i B_j D_k \Sb_{ijk} 
	&\to&	\frac{e}{m}\frac{ \Sb_{ijk} D_i B_j D_k  }{4m^2}	\\  
\eeqa

Finally, there is only one way to contract $D_i D_j D_k D_\ell$, which is as $\v{D}^4$.  Again, variations such as $D_i \v{D}^2 D_i$ need not be considered because they just reproduce already considered terms with $B$.
\beqa
	D_i D_j D_k D_\ell \delta_{ij} \delta_{k \ell} 
		&\to& \frac{\v{D}^4}{8m^3}
\eeqa
   

Having organised all the operators into all allowed combinations, we can write down the different orders of the Lagrangian.

The leading order terms in the Lagrangian, of order $mv^2$ and $(e/m) B$, are:
\beq \label{eq:nrLFirstOrder}
	\mathcal{L}_{mv^2} = \fnrb \Bigg\{ iD_0 +  \frac{\v{D}^2}{2m}  +  c_F \frac{e}{m} \v{S} \cdot \v{B}\Bigg \} \fnr
\eeq 

The part of the Lagrangian of order $mv^4$ is:
\beq \label{eq:nrLv4}
	\mathcal{L}_{mv^4} = \fnrb \Bigg\{
		\frac{\v{D}^4}{8m^2}
		+ c_D \frac{e (\v{D} \cdot \v{E} - \v{E} \cdot \v{D})}{8m^2} 
		+ c_Q \frac{eQ_{ij}(D_i E_j - E_i D_j)}{8m^2}
		+ c_S \frac{ i e \v{S} \cdot(\v{D} \times \v{E} - \v{E} \times \v{D}}{8m^2} \Bigg \} \fnr
\eeq

And the terms which are corrections to the magnetic field terms:
\beq \label{eq:nrLBv2} \begin{split}
	\mathcal{L}_{Bv^2} = &
		\fnrb \Bigg\{
			c_{W1} \frac{ e \v{D}^2 \v{S} \cdot \v{B} + \v{S} \cdot \v{B} \v{D}^2 }{8m^3}
			- c_{W2} \frac{e D_i (\v{S} \cdot \v{B}) D_i}{4m^3}
			+c_{p'p} \frac{ e [ (\v{S}\cdot \v{D})(\v{B} \cdot \v{D}) + (\v{B} \cdot \v{D})(\v{S}\cdot \v{D})]}{8m^3}
\\ &		+ c_{T_1} \frac{ e \bar{S}_{ijk} (D_i D_j B_k + B_k D_j D_i)}{8m^3}
		+ c_{T_2} \frac{ e \bar{S}_{ijk} D_i B_j D_k }{8m^3} \Bigg \} \fnr
\end{split}\eeq

\subsubsection{Full Lagrangian}
Combining all of the above, the full Lagrangian we consider is then:

\beq \label{eq:nrLFull}
\begin{split}
\mathcal{L}_{NRQED} = & \fnrb \Bigg\{
		iD_0 +  \frac{\v{D}^2}{2m}  + 	\frac{\v{D}^4}{8m^2}
		 + c_F \frac{e}{m} \v{S} \cdot \v{B}
		+ c_D \frac{e (\v{D} \cdot \v{E} - \v{E} \cdot \v{D})}{8m^2} 
		+ c_Q \frac{eQ_{ij}(D_i E_j - E_i D_j)}{8m^2}
\\	& + c_S \frac{ i e \v{S} \cdot(\v{D} \times \v{E} - \v{E} \times \v{D}}{8m^2}
		+ c_{W1} \frac{ e \v{D}^2 \v{S} \cdot \v{B} + \v{S} \cdot \v{B} \v{D}^2 }{8m^3}
		- c_{W2} \frac{e D_i (\v{S} \cdot \v{B}) D_i}{4m^3}
\\	&		+c_{p'p} \frac{ e [ (\v{S}\cdot \v{D})(\v{B} \cdot \v{D}) + (\v{B} \cdot \v{D})(\v{S}\cdot \v{D})]}{8m^3}
 	+ c_{T_1} \frac{ e \bar{S}_{ijk} (D_i D_j B_k + B_k D_j D_i)}{8m^3}
		+ c_{T_2} \frac{ e \bar{S}_{ijk} D_i B_j D_k }{8m^3} 
		\Bigg \} \fnr
\end{split}
\eeq


One of the features of this Lagrangian is that every coefficient is fixed by the one-photon interaction.  Although some terms might represent two-photon interactions, they are terms like $\v{S} \cdot \v{A} \times \v{E}$, whose coefficient is fixed by the gauge-invariant term $\v{S} \cdot \v{D} \times \v{E}$.  This in turn means that we can calculate the corrections to the $g$-factor by considering only one-photon interactions.














